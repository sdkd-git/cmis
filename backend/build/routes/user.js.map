{"version":3,"sources":["../../src/routes/user.js"],"names":["module","exports","app","post","passport","authenticate","session","config","accessLevels","admin","create","login","get","superAdmin","findAllUsers","findAdminUsers","findById","put","update","delete","deleteUser"],"mappings":";;AAAA;;;;AACA;;;;AACA;;AACA;;AAGA;;;;;;AACAA,OAAOC,OAAP,GAAiB,UAACC,GAAD,EAAS;AACxB;AACAA,MAAIC,IAAJ,CACE,mBADF,EAEEC,mBAASC,YAAT,CAAsB,KAAtB,EAA6B,EAAEC,SAAS,KAAX,EAA7B,CAFF,EAGE,6BAAUC,iBAAOC,YAAP,CAAoBC,KAA9B,EAAqCC,YAArC,CAHF;;AAMA;AACAR,MAAIC,IAAJ,CAAS,kBAAT,EAA6BQ,WAA7B;;AAEA;AACAT,MAAIU,GAAJ,CACE,uCADF,EAEER,mBAASC,YAAT,CAAsB,KAAtB,EAA6B;AAC3BC,aAAS;AADkB,GAA7B,CAFF,EAKE,6BAAUC,iBAAOC,YAAP,CAAoBC,KAApB,IAA6BF,iBAAOC,YAAP,CAAoBK,UAA3D,EAAuEC,kBAAvE,CALF;AAOA;AACAZ,MAAIU,GAAJ,CACE,iCADF,EAEER,mBAASC,YAAT,CAAsB,KAAtB,EAA6B;AAC3BC,aAAS;AADkB,GAA7B,CAFF,EAKE,6BAAUC,iBAAOC,YAAP,CAAoBK,UAA9B,EAA0CE,oBAA1C,CALF;;AAQA;AACAb,MAAIU,GAAJ,CACE,oBADF,EAEER,mBAASC,YAAT,CAAsB,KAAtB,EAA6B;AAC3BC,aAAS;AADkB,GAA7B,CAFF,EAKE,6BAAUC,iBAAOC,YAAP,CAAoBC,KAA9B,EAAqCO,cAArC,CALF;;AAQA;AACAd,MAAIe,GAAJ,CACE,oBADF,EAEEb,mBAASC,YAAT,CAAsB,KAAtB,EAA6B;AAC3BC,aAAS;AADkB,GAA7B,CAFF,EAKE,6BAAUC,iBAAOC,YAAP,CAAoBK,UAApB,IAAkCN,iBAAOC,YAAP,CAAoBC,KAAhE,EAAuES,YAAvE,CALF;;AAQA;AACAhB,MAAIiB,MAAJ,CACE,oBADF,EAEEf,mBAASC,YAAT,CAAsB,KAAtB,EAA6B;AAC3BC,aAAS;AADkB,GAA7B,CAFF,EAKE,6BAAUC,iBAAOC,YAAP,CAAoBC,KAA9B,EAAqCW,gBAArC,CALF;AAQD,CAvDD","file":"user.js","sourcesContent":["import passport from 'passport';\r\nimport config from '../config/config';\r\nimport { allowOnly } from '../services/routesHelper';\r\nimport { create, login, findAllUsers, \r\n    findById, update, deleteUser, findAdminUsers\r\n} from '../controllers/user';\r\nimport _ from \"lodash\";\r\nmodule.exports = (app) => {\r\n  // create a new user\r\n  app.post(\r\n    '/api/users/create',\r\n    passport.authenticate('jwt', { session: false }),\r\n    allowOnly(config.accessLevels.admin, create)\r\n  );\r\n\r\n  // user login\r\n  app.post('/api/users/login', login);\r\n\r\n  //retrieve all users\r\n  app.get(\r\n    '/api/users/findAllUsers/:cityId/:role', \r\n    passport.authenticate('jwt', { \r\n      session: false \r\n    }),\r\n    allowOnly(config.accessLevels.admin || config.accessLevels.superAdmin, findAllUsers)\r\n  );\r\n  // retrieve user by role\r\n  app.get(\r\n    '/api/users/findAdminUsers/:role', \r\n    passport.authenticate('jwt', { \r\n      session: false \r\n    }),\r\n    allowOnly(config.accessLevels.superAdmin, findAdminUsers)\r\n  );\r\n\r\n  // retrieve user by id\r\n  app.get(\r\n    '/api/users/:userId',\r\n    passport.authenticate('jwt', {\r\n      session: false,\r\n    }),\r\n    allowOnly(config.accessLevels.admin, findById)\r\n  );\r\n\r\n  // update a user with id\r\n  app.put(\r\n    '/api/users/:userId',\r\n    passport.authenticate('jwt', {\r\n      session: false,\r\n    }),\r\n    allowOnly(config.accessLevels.superAdmin || config.accessLevels.admin, update)\r\n  );\r\n\r\n  // delete a user\r\n  app.delete(\r\n    '/api/users/:userId',\r\n    passport.authenticate('jwt', {\r\n      session: false,\r\n    }),\r\n    allowOnly(config.accessLevels.admin, deleteUser)\r\n  );\r\n\r\n};\r\n"]}