{"version":3,"sources":["../../src/config/passport.js"],"names":["Users","models","User","opts","jwtFromRequest","ExtractJwt","fromAuthHeaderAsBearerToken","secretOrKey","module","exports","passport","use","JwtStrategy","jwt_payload","done","findAll","where","id","then","user","length","catch","console","log","err"],"mappings":";;AAAA;;AACA;;;;;;AAEA,IAAMA,QAAQC,iBAAOC,IAArB;;AAEA,IAAMC,OAAO,EAAb;AACAA,KAAKC,cAAL,GAAsBC,wBAAWC,2BAAX,EAAtB;AACAH,KAAKI,WAAL,GAAmB,QAAnB;AACA;AACA;;AAEA;AACAC,OAAOC,OAAP,GAAiB,oBAAY;AAC3BC,WAASC,GAAT,CACE,IAAIC,qBAAJ,CAAgBT,IAAhB,EAAsB,UAACU,WAAD,EAAcC,IAAd,EAAuB;AAC3Cd,UAAMe,OAAN,CAAc,EAAEC,OAAO,EAAEC,IAAIJ,YAAYI,EAAlB,EAAT,EAAd,EACGC,IADH,CACQ,gBAAQ;AACZ,UAAIC,KAAKC,MAAT,EAAiB;AACf,eAAON,KAAK,IAAL,EAAWK,IAAX,CAAP;AACD;AACD,aAAOL,KAAK,IAAL,EAAW,KAAX,CAAP;AACD,KANH,EAOGO,KAPH,CAOS;AAAA,aAAOC,QAAQC,GAAR,CAAYC,GAAZ,CAAP;AAAA,KAPT;AAQD,GATD,CADF;AAYD,CAbD","file":"passport.js","sourcesContent":["import { Strategy as JwtStrategy, ExtractJwt } from 'passport-jwt'\r\nimport models from '../models'\r\n\r\nconst Users = models.User;\r\n\r\nconst opts = {};\r\nopts.jwtFromRequest = ExtractJwt.fromAuthHeaderAsBearerToken();\r\nopts.secretOrKey = 'secret';\r\n// opts.issuer = 'accounts.examplesoft.com';\r\n// opts.audience = 'yoursite.net';\r\n\r\n// create jwt strategy\r\nmodule.exports = passport => {\r\n  passport.use(\r\n    new JwtStrategy(opts, (jwt_payload, done) => {\r\n      Users.findAll({ where: { id: jwt_payload.id } })\r\n        .then(user => {\r\n          if (user.length) {\r\n            return done(null, user);\r\n          }\r\n          return done(null, false);\r\n        })\r\n        .catch(err => console.log(err));\r\n    })\r\n  );\r\n};\r\n"]}